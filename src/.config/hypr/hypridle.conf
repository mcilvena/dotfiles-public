# Hypridle Configuration - Automatic Screen Locking
# Modern idle management for Hyprland

general {
    lock_cmd = pidof hyprlock || hyprlock       # avoid starting multiple hyprlock instances
    before_sleep_cmd = ~/.config/hypr/scripts/monitor-reset.sh safe-disable && loginctl lock-session    # prepare monitors and lock before suspend
    after_sleep_cmd = ~/.config/hypr/scripts/monitor-reset.sh  # reset monitors after suspend
}

# Dim screen after 2.5 minutes
listener {
    timeout = 150                                # 2.5min
    on-timeout = brightnessctl -s set 10         # set monitor backlight to minimum, avoid 0 on OLED monitor
    on-resume = brightnessctl -r                 # restore previous backlight value
}

# Turn off keyboard backlight after 5 minutes
listener { 
    timeout = 300                                # 5min
    on-timeout = brightnessctl -sd rgb:kbd_backlight set 0 # turn off keyboard backlight
    on-resume = brightnessctl -rd rgb:kbd_backlight        # restore keyboard backlight
}

# Lock screen after 10 minutes
listener {
    timeout = 600                                # 10min
    on-timeout = loginctl lock-session           # lock screen when timeout has passed
}

# Turn off screen after 15 minutes (after lock)
listener {
    timeout = 900                                # 15min
    on-timeout = ~/.config/hypr/scripts/monitor-reset.sh safe-disable      # safely prepare monitors before turning off
    on-resume = sleep 1 && ~/.config/hypr/scripts/monitor-reset.sh  # wait briefly, then reset monitors when activity is detected
}

# Suspend system after 30 minutes
listener {
    timeout = 1800                               # 30min
    on-timeout = systemctl suspend              # suspend pc
}